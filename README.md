# üîß RevitMEPHoleManager

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –¥–ª—è MEP —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ Autodesk Revit**

[![–í–µ—Ä—Å–∏—è](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/your-username/RevitMEPHoleManager)
[![Revit](https://img.shields.io/badge/Revit-2020%2B-orange.svg)](https://www.autodesk.com/products/revit)
[![.NET](https://img.shields.io/badge/.NET%20Framework-4.8-purple.svg)](https://dotnet.microsoft.com/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

---

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

**RevitMEPHoleManager** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –ø–ª–∞–≥–∏–Ω –¥–ª—è Autodesk Revit, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π (MEP). –ü–ª–∞–≥–∏–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Ç—Ä—É–±, –≤–æ–∑–¥—É—Ö–æ–≤–æ–¥–æ–≤ –∏ –∫–∞–±–µ–ª—å–Ω—ã—Ö –ª–æ—Ç–∫–æ–≤ —Å –Ω–µ—Å—É—â–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (—Å—Ç–µ–Ω–∞–º–∏, –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è–º–∏, –ø–æ—Ç–æ–ª–∫–∞–º–∏) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è.

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π** ‚Äî –ø–æ–∏—Å–∫ –≤—Å–µ—Ö –º–µ—Å—Ç, –≥–¥–µ MEP —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- ‚úÖ **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π** ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±–ª–∏–∑–∫–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –≤ –æ–¥–∏–Ω –ø—Ä–æ–µ–º
- ‚úÖ **–¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤** ‚Äî —É—á–µ—Ç –¥–∏–∞–º–µ—Ç—Ä–æ–≤, —É–∫–ª–æ–Ω–æ–≤ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–∑–æ—Ä–æ–≤
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –Ω–∞–∫–ª–æ–Ω–Ω—ã–º–∏ —Ç—Ä—É–±–∞–º–∏ –∏ –¥—É–≥–æ–≤—ã–º–∏ —Å—Ç–µ–Ω–∞–º–∏
- ‚úÖ **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–æ–Ω** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–ø—É—Å–∫ –¥–≤–µ—Ä–Ω—ã—Ö/–æ–∫–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–º–æ–≤ –∏ –Ω–µ—Å—É—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ **–†–∞–±–æ—Ç–∞ —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏** ‚Äî –∞–Ω–∞–ª–∏–∑ MEP —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –æ—Ç—á–µ—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –∏ —Ö–æ—Å—Ç-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- ‚úÖ **–õ–æ–≥ —Ä–∞—Å—á–µ—Ç–æ–≤** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Autodesk Revit**: 2020, 2021, 2022, 2023, 2024, 2025+
- **.NET Framework**: 4.8 –∏–ª–∏ –≤—ã—à–µ
- **–û–°**: Windows 10/11 (64-bit)
- **–ü–∞–º—è—Ç—å**: –º–∏–Ω–∏–º—É–º 8 –ì–ë –û–ó–£ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 16 –ì–ë)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ** —Ñ–∞–π–ª—ã –ø–ª–∞–≥–∏–Ω–∞ –∏–∑ —Ä–µ–ª–∏–∑–æ–≤ –∏–ª–∏ —Å–æ–±–µ—Ä–∏—Ç–µ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ** `RevitMEPHoleManager.dll` –≤ –ø–∞–ø–∫—É –ø–ª–∞–≥–∏–Ω–æ–≤ Revit:
   ```
   %APPDATA%\Autodesk\Revit\Addins\2024\
   ```
3. **–°–æ–∑–¥–∞–π—Ç–µ** —Ñ–∞–π–ª –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ `RevitMEPHoleManager.addin`:
   ```xml
   <?xml version="1.0" encoding="utf-8"?>
   <RevitAddIns>
     <AddIn Type="Application">
       <Name>MEP Hole Manager</Name>
       <Assembly>RevitMEPHoleManager.dll</Assembly>
       <FullClassName>RevitMEPHoleManager.App</FullClassName>
       <ClientId>b83544e2-ec71-4e5f-9739-c23573f0de1c</ClientId>
       <VendorId>ADSK</VendorId>
       <VendorDescription>MEP Tools</VendorDescription>
     </AddIn>
   </RevitAddIns>
   ```
4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ** Revit

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å MEP —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤ Revit
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"MEP Hole Manager"** –≤ –ª–µ–Ω—Ç–µ
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ó–∞–ø—É—Å–∫"**
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–º–µ–π—Å—Ç–≤–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
5. –ù–∞–∂–º–∏—Ç–µ **"–°—Ç–∞—Ä—Ç"** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

---

## üéõÔ∏è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ

![–ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø–ª–∞–≥–∏–Ω–∞](docs/images/main-window.png)

#### üîß –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|-----------------------|
| **–°–µ–º–µ–π—Å—Ç–≤–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π** | Generic Model —Å–µ–º–µ–π—Å—Ç–≤–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ä—Å—Ç–∏–π | –ü–µ—Ä–≤–æ–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ |
| **–ó–∞–∑–æ—Ä (–º–º)** | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–∑–æ—Ä –≤–æ–∫—Ä—É–≥ MEP —ç–ª–µ–º–µ–Ω—Ç–∞ | 50 –º–º |
| **–û–±—ä–µ–¥–∏–Ω—è—Ç—å –æ—Ç–≤–µ—Ä—Å—Ç–∏—è** | –í–∫–ª—é—á–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –±–ª–∏–∑–∫–∏—Ö –æ—Ç–≤–µ—Ä—Å—Ç–∏–π | –í—ã–∫–ª—é—á–µ–Ω–æ |
| **–ú–∞–∫—Å. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–º–º)** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è | 200 –º–º |

#### üìä –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π

–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –Ω–∞–π–¥–µ–Ω–Ω–æ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏:

- **–•–æ—Å—Ç** ‚Äî –∏–º—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
- **Host Id** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ö–æ—Å—Ç–∞
- **MEP Id** ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
- **–§–æ—Ä–º–∞** ‚Äî —Ç–∏–ø —Å–µ—á–µ–Ω–∏—è (Round/Rect/Square/Tray)
- **–†–∞–∑–º–µ—Ä—ã** ‚Äî –≥–∞–±–∞—Ä–∏—Ç—ã —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–º
- **–û—Ç–≤–µ—Ä—Å—Ç–∏–µ** ‚Äî —Ä–∞—Å—á–µ—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –æ—Ç–≤–µ—Ä—Å—Ç–∏—è
- **–¢–∏–ø–æ—Ä–∞–∑–º–µ—Ä** ‚Äî –∏–º—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–∏–ø–∞ —Å–µ–º–µ–π—Å—Ç–≤–∞
- **–ù–∞–∫–ª–æ–Ω** ‚Äî –µ—Å—Ç—å –ª–∏ —É–∫–ª–æ–Ω —É —ç–ª–µ–º–µ–Ω—Ç–∞
- **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ** ‚Äî –∑–∞–∑–æ—Ä –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

#### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ö–æ—Å—Ç–∞–º

–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –Ω–∞ –∫–∞–∂–¥–æ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ.

#### üìã –í–∫–ª–∞–¥–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

1. **"–¢—Ä—É–±—ã –ø—Ä–æ–µ–∫—Ç–∞"** ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä—É–± —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
2. **"–õ–æ–≥ —Ä–∞—Å—á—ë—Ç–∞"** ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π –∂—É—Ä–Ω–∞–ª –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–∞

```
RevitMEPHoleManager/
‚îú‚îÄ‚îÄ üìÑ App.cs                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø–ª–∞–≥–∏–Ω–∞
‚îú‚îÄ‚îÄ üìÑ ShowGuiCommand.cs         # –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ UI
‚îú‚îÄ‚îÄ üìÑ MyMainWindow.xaml(.cs)    # –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ üìÑ IntersectionStats.cs      # –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π
‚îú‚îÄ‚îÄ üìÑ Calculaters.cs            # –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
‚îú‚îÄ‚îÄ üìÑ MergeService.cs           # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
‚îú‚îÄ‚îÄ üìÑ SizeHelper.cs             # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ MEP
‚îú‚îÄ‚îÄ üìÑ HostStatRow.cs            # –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚îî‚îÄ‚îÄ üìÑ PipeRow.cs                # –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Ç—Ä—É–±
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

#### üèóÔ∏è –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Ö–æ—Å—Ç—ã)

| –¢–∏–ø | Revit Category | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|-----|----------------|-------------|
| **–°—Ç–µ–Ω—ã** | `OST_Walls` | –ü—Ä—è–º—ã–µ –∏ –¥—É–≥–æ–≤—ã–µ, –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–µ |
| **–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏—è** | `OST_Floors` | –ü–ª–æ—Å–∫–∏–µ –∏ –Ω–∞–∫–ª–æ–Ω–Ω—ã–µ |
| **–ü–æ—Ç–æ–ª–∫–∏** | `OST_Ceilings` | –ü–æ–¥–≤–µ—Å–Ω—ã–µ –∏ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–µ |

#### üîß MEP —ç–ª–µ–º–µ–Ω—Ç—ã

| –¢–∏–ø | Revit Category | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑–º–µ—Ä–æ–≤ |
|-----|----------------|-------------------|
| **–¢—Ä—É–±—ã** | `OST_PipeCurves` | –ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (DN) |
| **–í–æ–∑–¥—É—Ö–æ–≤–æ–¥—ã** | `OST_DuctCurves` | –®–∏—Ä–∏–Ω–∞ √ó –í—ã—Å–æ—Ç–∞ |
| **–ö–∞–±–µ–ª—å–Ω—ã–µ –ª–æ—Ç–∫–∏** | `OST_CableTray` | –®–∏—Ä–∏–Ω–∞ √ó –í—ã—Å–æ—Ç–∞ |

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

#### 1Ô∏è‚É£ –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

```csharp
// –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ö–æ—Å—Ç-—ç–ª–µ–º–µ–Ω—Ç–æ–≤
var hosts = new FilteredElementCollector(doc)
    .WherePasses(new LogicalOrFilter(
        new ElementClassFilter(typeof(Wall)),
        new ElementClassFilter(typeof(Floor))))
    .ToElements();

// –°–±–æ—Ä MEP –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —Å–≤—è–∑–µ–π
var mepElements = CollectMEPFromAllModels(doc);
```

#### 2Ô∏è‚É£ –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π

–î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã "—Ö–æ—Å—Ç-MEP":

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ bounding box** —ç–ª–µ–º–µ–Ω—Ç–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è** AABB –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
3. **–†–∞—Å—á–µ—Ç —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è** –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è
4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** —ç–ª–µ–º–µ–Ω—Ç–∞ (DN, —Ä–∞–∑–º–µ—Ä—ã)
5. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** —Ö–æ—Å—Ç–∞

```csharp
// –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
bool Intersects(BoundingBoxXYZ bbox1, BoundingBoxXYZ bbox2)
{
    return (bbox1.Min.X <= bbox2.Max.X && bbox1.Max.X >= bbox2.Min.X) &&
           (bbox1.Min.Y <= bbox2.Max.Y && bbox1.Max.Y >= bbox2.Min.Y) &&
           (bbox1.Min.Z <= bbox2.Max.Z && bbox1.Max.Z >= bbox2.Min.Z);
}
```

#### 3Ô∏è‚É£ –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

**–î–ª—è –ø—Ä—è–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**
```
–†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ä—Å—Ç–∏—è = –†–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ + 2 √ó –ó–∞–∑–æ—Ä
```

**–î–ª—è –Ω–∞–∫–ª–æ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**
```
–í—ã—Å–æ—Ç–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è = –†–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ / cos(Œ±) + 2 √ó –ó–∞–∑–æ—Ä
–≥–¥–µ Œ± ‚Äî —É–≥–æ–ª –º–µ–∂–¥—É –æ—Å—å—é —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –Ω–æ—Ä–º–∞–ª—å—é –∫ —Å—Ç–µ–Ω–µ
```

**–î–ª—è –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä—É–±:**
```
–ó–∞–∑–æ—Ä = 2 √ó –û–±—ã—á–Ω—ã–π –∑–∞–∑–æ—Ä (—É–¥–≤–æ–µ–Ω–Ω—ã–π –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏)
```

#### 4Ô∏è‚É£ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

–ö–æ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–∞ –æ–ø—Ü–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è:

1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** –ø–æ —Ö–æ—Å—Ç-—ç–ª–µ–º–µ–Ω—Ç—É
2. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é (–µ—Å–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ ‚â§ –ø–æ—Ä–æ–≥)
3. **–†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ MBR** (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞)
4. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞:**

```
–®–∏—Ä–∏–Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ = Œ£(–¥–∏–∞–º–µ—Ç—Ä—ã/—à–∏—Ä–∏–Ω—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤) + 2 √ó –æ–±—â–∏–π –∑–∞–∑–æ—Ä
–í—ã—Å–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ = Œ£(–¥–∏–∞–º–µ—Ç—Ä—ã/–≤—ã—Å–æ—Ç—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤) + 2 √ó –æ–±—â–∏–π –∑–∞–∑–æ—Ä
```

#### 5Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

**–ò—Å–∫–ª—é—á–∞—é—Ç—Å—è –æ—Ç–≤–µ—Ä—Å—Ç–∏—è:**
- –í –¥–≤–µ—Ä–Ω—ã—Ö –∏ –æ–∫–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–º–∞—Ö
- –†—è–¥–æ–º —Å –Ω–µ—Å—É—â–∏–º–∏ –∫–æ–ª–æ–Ω–Ω–∞–º–∏ –∏ –±–∞–ª–∫–∞–º–∏  
- –ü—Ä–∏ "—Å–∫–æ–ª—å–∑—è—â–∏—Ö" –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è—Ö (—É–≥–æ–ª < 30¬∞)
- –í –º–µ—Å—Ç–∞—Ö —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–µ–π

#### 6Ô∏è‚É£ –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

1. **–í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–π –≥—Ä–∞–Ω–∏** —Ö–æ—Å—Ç–∞ (PickHostFace)
2. **–°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–∏—Å–∫ —Ç–∏–ø–æ—Ä–∞–∑–º–µ—Ä–∞** —Å–µ–º–µ–π—Å—Ç–≤–∞
3. **–¢–æ—á–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —É—á–µ—Ç–æ–º –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
4. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —É—Ä–æ–≤–Ω—è
5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö

---

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–º–µ–π—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

–ü–ª–∞–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Generic Model —Å–µ–º–µ–π—Å—Ç–≤–∞–º–∏, –∏–º–µ—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `W`, `Width`, `HoleWidth` | Instance | –®–∏—Ä–∏–Ω–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è |
| `H`, `Height`, `HoleHeight` | Instance | –í—ã—Å–æ—Ç–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è |
| `–£—Ä–æ–≤–µ–Ω—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏` | Instance | –£—Ä–æ–≤–µ–Ω—å –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `–û—Ç–º–µ—Ç–∫–∞ –æ—Ç —É—Ä–æ–≤–Ω—è` | Instance | –í—ã—Å–æ—Ç–Ω–∞—è –æ—Ç–º–µ—Ç–∫–∞ |

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–µ–π—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ **Generic Model** (face-based)
2. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `Width` –∏ `Height`
3. –°–æ–∑–¥–∞–π—Ç–µ 3D –≥–µ–æ–º–µ—Ç—Ä–∏—é –æ—Ç–≤–µ—Ä—Å—Ç–∏—è (void extrusion)
4. –°–≤—è–∂–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ–º–µ–π—Å—Ç–≤–æ –≤ –ø—Ä–æ–µ–∫—Ç

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞

–î–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–∑–¥–∞–π—Ç–µ `.addin` —Ñ–∞–π–ª:

```xml
<?xml version="1.0" encoding="utf-8"?>
<RevitAddIns>
  <AddIn Type="Application">
    <Name>MEP Hole Manager</Name>
    <Assembly>RevitMEPHoleManager.dll</Assembly>
    <FullClassName>RevitMEPHoleManager.App</FullClassName>
    <ClientId>b83544e2-ec71-4e5f-9739-c23573f0de1c</ClientId>
    <VendorId>ADSK</VendorId>
    <VendorDescription>MEP Tools, v1.0</VendorDescription>
  </AddIn>
</RevitAddIns>
```

---

## üî¨ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ—Å—Ç–∞—è —Ç—Ä—É–±–∞ —á–µ—Ä–µ–∑ —Å—Ç–µ–Ω—É

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –¢—Ä—É–±–∞ DN150 –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ —á–µ—Ä–µ–∑ —Å—Ç–µ–Ω—É 200–º–º
- –ó–∞–∑–æ—Ä: 25–º–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–≤–µ—Ä—Å—Ç–∏–µ: 200√ó200–º–º (150 + 2√ó25)
- –¢–∏–ø–æ—Ä–∞–∑–º–µ—Ä: "200x200"

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–∞–∫–ª–æ–Ω–Ω–∞—è —Ç—Ä—É–±–∞

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –¢—Ä—É–±–∞ DN100 –ø–æ–¥ —É–≥–ª–æ–º 30¬∞ –∫ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
- –ó–∞–∑–æ—Ä: 25–º–º

**–†–∞—Å—á–µ—Ç:**
```
cos(30¬∞) = 0.866
–í—ã—Å–æ—Ç–∞ = 100 / 0.866 + 2√ó25 = 165–º–º
–®–∏—Ä–∏–Ω–∞ = 100 + 2√ó25 = 150–º–º
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–≤–µ—Ä—Å—Ç–∏–µ: 150√ó165–º–º
- –¢–∏–ø–æ—Ä–∞–∑–º–µ—Ä: "150x165"

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–ª–∞—Å—Ç–µ—Ä —Ç—Ä—É–±

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- 3 —Ç—Ä—É–±—ã: DN100, DN150, DN100
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –æ—Å—è–º–∏: 200–º–º, 200–º–º
- –ó–∞–∑–æ—Ä: 25–º–º, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ: 300–º–º

**–†–∞—Å—á–µ—Ç:**
```
–®–∏—Ä–∏–Ω–∞ = 100 + 150 + 100 + 2√ó25 = 400–º–º
–í—ã—Å–æ—Ç–∞ = 100 + 150 + 100 + 2√ó25 = 400–º–º
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û–¥–Ω–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏–µ: 400√ó400–º–º
- –¢–∏–ø–æ—Ä–∞–∑–º–µ—Ä: "400x400"

---

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã

#### ‚ùå "–°–µ–º–µ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"

**–ü—Ä–∏—á–∏–Ω–∞:** –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç Generic Model —Å–µ–º–µ–π—Å—Ç–≤  
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç–µ face-based —Å–µ–º–µ–π—Å—Ç–≤–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

#### ‚ùå "–ù–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π"

**–ü—Ä–∏—á–∏–Ω—ã:**
- MEP —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤—ã
- –≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–æ–µ–º–∞—Ö –æ–∫–æ–Ω/–¥–≤–µ—Ä–µ–π
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è –º–æ–¥–µ–ª–∏

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–¥–µ–ª—å –≤ 3D –≤–∏–¥–µ

#### ‚ùå "–û—Ç–≤–µ—Ä—Å—Ç–∏—è –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è"

**–ü—Ä–∏—á–∏–Ω—ã:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –≠–ª–µ–º–µ–Ω—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ä–∞–±–æ—á–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö
- –û—à–∏–±–∫–∏ –≤ —Å–µ–º–µ–π—Å—Ç–≤–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π

**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—á–∏–µ –Ω–∞–±–æ—Ä—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ–º–µ–π—Å—Ç–≤–∞

#### ‚ùå ArgumentNullException

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤  
**–†–µ—à–µ–Ω–∏–µ:** –ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### –î–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π:

- **–û—Ç–∫–ª—é—á–∏—Ç–µ** –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
- **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ** –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –≤–∏–¥–µ
- **–ó–∞–∫—Ä–æ–π—Ç–µ** –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ** —Ä–∞–±–æ—á–∏–µ –Ω–∞–±–æ—Ä—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

| –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ | –ó–∞–∑–æ—Ä | –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ | –ú–∞–∫—Å. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ |
|---------------|-------|-------------|------------------|
| < 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | 25–º–º | ‚úÖ | 200–º–º |
| 1000-5000 | 25–º–º | ‚úÖ | 150–º–º |
| > 5000 | 50–º–º | ‚ùå | ‚Äî |

---

## üîß –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- **Visual Studio 2019+** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π .NET Framework 4.8
- **Revit 2024 SDK** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Revit)
- **Git** –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### –®–∞–≥–∏ —Å–±–æ—Ä–∫–∏

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```bash
git clone https://github.com/your-username/RevitMEPHoleManager.git
cd RevitMEPHoleManager
```

2. **–û—Ç–∫—Ä—ã—Ç–∏–µ –≤ Visual Studio:**
```bash
start RevitMEPHoleManager.sln
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É—Ç–µ–π –∫ API Revit:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –ø—Ä–æ–µ–∫—Ç–∞ `.csproj`
   - –ò–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç–∏ –∫ `RevitAPI.dll` –∏ `RevitAPIUI.dll` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
   ```xml
   <Reference Include="RevitAPI">
     <HintPath>C:\Program Files\Autodesk\Revit 2024\RevitAPI.dll</HintPath>
   </Reference>
   ```

4. **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
   - –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é **Release**
   - –ù–∞–∂–º–∏—Ç–µ **Build ‚Üí Build Solution** (Ctrl+Shift+B)

5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –§–∞–π–ª `bin\Release\RevitMEPHoleManager.dll`
   - –ì–æ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ Revit

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–ø–∫—É Revit:**
```xml
<Target Name="PostBuild" AfterTargets="PostBuildEvent">
  <Copy SourceFiles="$(TargetPath)" 
        DestinationFolder="%APPDATA%\Autodesk\Revit\Addins\2024\" />
</Target>
```

**–û—Ç–ª–∞–¥–∫–∞:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Revit –∫–∞–∫ —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í–∫–ª—é—á–∏—Ç–µ "Debug ‚Üí Attach to Process ‚Üí Revit.exe"
3. –ü–æ—Å—Ç–∞–≤—å—Ç–µ breakpoints –≤ –∫–æ–¥–µ
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞–≥–∏–Ω –≤ Revit

---

## üìö API Reference

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

#### IntersectionStats
–ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π MEP —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–∞–º–∏.

```csharp
public static (int wRnd, int wRec, int fRnd, int fRec, 
               List<IntersectRow> rows, List<HostStatRow> hostStats) 
       Analyze(IEnumerable<Element> hosts, 
               IEnumerable<(Element elem, Transform tx)> mepList, 
               double clearanceMm)
```

#### Calculaters
–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π —Å —É—á–µ—Ç–æ–º —É–∫–ª–æ–Ω–æ–≤.

```csharp
public static void GetHoleSizeIncline(bool isRound, double elemWmm, 
                                      double elemHmm, double clearanceMm, 
                                      XYZ axisLocal, out double holeWmm, 
                                      out double holeHmm)
```

#### MergeService
–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –±–ª–∏–∑–∫–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ä—Å—Ç–∏–π.

```csharp
public static IEnumerable<IntersectRow> Merge(IEnumerable<IntersectRow> rows, 
                                              double gapMm, double clearanceMm, 
                                              HoleLogger log)
```

#### SizeHelper
–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ MEP —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

```csharp
public static bool TryGetSizes(Element mep, out double wMm, 
                               out double hMm, out ShapeKind shape)
```

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### IntersectRow
```csharp
public class IntersectRow 
{
    public int HostId { get; set; }
    public int MepId { get; set; }
    public XYZ Center { get; set; }
    public XYZ PipeDir { get; set; }
    public XYZ LocalCtr { get; set; }
    public XYZ AxisLocal { get; set; }
    public double WidthLocFt { get; set; }
    public double HeightLocFt { get; set; }
    public double HoleWidthMm { get; set; }
    public double HoleHeightMm { get; set; }
    public string HoleTypeName { get; set; }
    public bool IsMerged { get; set; }
    public bool IsDiagonal { get; set; }
    public XYZ GroupCtr { get; set; }
    public double? GapMm { get; set; }
}
```

#### HostStatRow
```csharp
public class HostStatRow 
{
    public int HostId { get; set; }
    public string HostName { get; set; }
    public int Round { get; set; }
    public int Rect { get; set; }
}
```

---

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ú—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∫–ª–∞–¥ –≤ —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞!

### –ö–∞–∫ –≤–Ω–µ—Å—Ç–∏ —Å–≤–æ–π –≤–∫–ª–∞–¥

1. **Fork** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **–°–æ–∑–¥–∞–π—Ç–µ** –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/amazing-feature`)
3. **–í–Ω–µ—Å–∏—Ç–µ** –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ **–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –∏—Ö
4. **–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ** –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
5. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ** –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
6. **–°–æ–∑–¥–∞–π—Ç–µ** Pull Request

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

- **C# Naming Conventions** –ø–æ Microsoft
- **XML Documentation** –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- **Unit Tests** –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **Error Handling** —Å try-catch –±–ª–æ–∫–∞–º–∏
- **Performance** ‚Äî –∏–∑–±–µ–≥–∞–π—Ç–µ –ª–∏—à–Ω–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö MEP –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- üéØ –£–ª—É—á—à–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ —ç–∫—Å–ø–æ—Ä—Ç
- üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BIM360/ACC

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

```
MIT License

Copyright (c) 2025 RevitMEPHoleManager

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## üë• –ê–≤—Ç–æ—Ä—ã –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- **–û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫**: [–í–∞—à–µ –∏–º—è](https://github.com/your-username)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–æ–º–∞–Ω–¥–∞ BIM-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞

### –û—Å–æ–±–∞—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å

- **Autodesk Revit API** –∑–∞ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–°–æ–æ–±—â–µ—Å—Ç–≤—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ Revit** –∑–∞ —Å–æ–≤–µ—Ç—ã –∏ best practices
- **Beta-—Ç–µ—Å—Ç–µ—Ä–∞–º** –∑–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

- üìß **Email**: support@revittools.com
- üí¨ **Telegram**: [@revitmetools](https://t.me/revitmetools)
- üêõ **Issues**: [GitHub Issues](https://github.com/your-username/RevitMEPHoleManager/issues)
- üìñ **Wiki**: [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://github.com/your-username/RevitMEPHoleManager/wiki)

### –û—Ç—á–µ—Ç—ã –æ–± –æ—à–∏–±–∫–∞—Ö

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ issue —É–∫–∞–∂–∏—Ç–µ:

1. **–í–µ—Ä—Å–∏—é Revit** –∏ **–≤–µ—Ä—Å–∏—é –ø–ª–∞–≥–∏–Ω–∞**
2. **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** –∏ —à–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
3. **–°–∫—Ä–∏–Ω—à–æ—Ç—ã** –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –æ—à–∏–±–æ–∫
4. **–õ–æ–≥-—Ñ–∞–π–ª—ã** –∏–∑ –≤–∫–ª–∞–¥–∫–∏ "–õ–æ–≥ —Ä–∞—Å—á—ë—Ç–∞"
5. **–¢–µ—Å—Ç–æ–≤—É—é –º–æ–¥–µ–ª—å** (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

### –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —É–ª—É—á—à–µ–Ω–∏—è

–ú—ã –æ—Ç–∫—Ä—ã—Ç—ã –∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º! –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issues —Å —Ç–µ–≥–æ–º `enhancement`.

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v1.0.0 (2025-01-XX)

#### ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π MEP —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞–∫–ª–æ–Ω–Ω—ã—Ö —Ç—Ä—É–± –∏ –¥—É–≥–æ–≤—ã—Ö —Å—Ç–µ–Ω
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–µ–º–æ–≤ –∏ –Ω–µ—Å—É—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –†–∞–±–æ—Ç–∞ —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏
- –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ (ArgumentNullException)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞—Å—á–µ—Ç–∞
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Revit 2020-2025+

#### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ null references –≤ –≥–µ–æ–º–µ—Ç—Ä–∏–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å CylindricalFace
- –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∑–∞–∑–æ—Ä–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

---

## üéØ –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

### v1.1.0 (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Q2 2025)
- üîß –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–±–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤
- üìä –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ Excel/PDF
- üé® –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Å—Ç–∏–ª–∏ –∏ —à–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
- üîÑ Batch processing –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### v1.2.0 (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Q3 2025)
- üåê –ê–Ω–≥–ª–∏–π—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
- üîå API –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- üì± –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–æ–≤
- ‚òÅÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### v2.0.0 (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Q4 2025)
- ü§ñ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
- üèóÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä–º–∞—Ç—É—Ä—ã –∏ –∑–∞–∫–ª–∞–¥–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π
- üìê 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã—Ö –æ—Ç–≤–µ—Ä—Å—Ç–∏–π
- üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞–º–∏

---

**‚≠ê –ï—Å–ª–∏ –ø–ª–∞–≥–∏–Ω –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É –Ω–∞ GitHub!**

**üì¢ –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –¥–µ–ª–∏—Ç–µ—Å—å –æ–ø—ã—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è!**

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-XX*